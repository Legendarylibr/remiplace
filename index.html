<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="(r) EMI / Place - Token-gated collaborative pixel canvas">
  <title>(r) EMI / Place</title>
  <link rel="stylesheet" href="style.css?v=1768587338132">
  <!-- Ethers.js v6 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.9.0/ethers.umd.min.js" 
          crossorigin="anonymous"></script>
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <div class="logo-section">
        <h1 class="logo bauhaus">
          <span class="logo-paren">(</span><span class="logo-r">r</span><span class="logo-paren">)</span><span class="logo-emi">EMI</span><span class="logo-slash">/</span><span class="logo-place">Place</span>
        </h1>
        <div class="pixel-counter">
          <span id="pixel-count">0</span> <span class="counter-label">pixels</span>
        </div>
      </div>
      
      <!-- Mondrian Composition -->
      <div class="mondrian-bar">
        <div class="m-red"></div>
        <div class="m-white"></div>
        <div class="m-blue"></div>
        <div class="m-yellow"></div>
        <div class="m-white"></div>
        <div class="m-red"></div>
      </div>
      
      <div class="wallet-section">
        <div id="network-badge" class="network-badge hidden">
          <span id="network-name"></span>
        </div>
        <div id="wallet-status" class="wallet-status">
          <span id="status-text">Disconnected</span>
          <div id="wallet-dropdown" class="wallet-dropdown hidden">
            <button id="disconnect-btn" class="wallet-dropdown-item">Disconnect</button>
          </div>
        </div>
        <button id="connect-btn" class="btn btn-primary">Connect Wallet</button>
      </div>
    </header>

    <!-- Authorization Banner -->
    <div id="auth-banner" class="auth-banner hidden">
      <span id="auth-message"></span>
    </div>

    <!-- Wallet Selection Modal -->
    <div id="wallet-modal" class="modal hidden">
      <div class="modal-content">
        <h2>Connect Wallet</h2>
        <p>Select a wallet to connect</p>
        <div id="wallet-options" class="wallet-options"></div>
        <button id="close-wallet-modal-btn" class="btn btn-secondary">Cancel</button>
      </div>
    </div>

    <!-- Wrong Network Modal -->
    <div id="network-modal" class="modal hidden">
      <div class="modal-content">
        <h2>Wrong Network</h2>
        <p>Please switch to a supported network to continue.</p>
        <div id="network-options" class="network-options"></div>
        <button id="close-modal-btn" class="btn btn-secondary">Cancel</button>
      </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Canvas Container -->
      <div class="canvas-container">
        <canvas id="pixel-canvas"></canvas>
        <div id="canvas-overlay" class="canvas-overlay hidden">
          <span>View Only</span>
        </div>
      </div>

      <!-- Controls Panel -->
      <aside class="controls-panel">
        <!-- Palette -->
        <section class="palette-section">
          <h3>Palette</h3>
          <div id="palette" class="palette"></div>
        </section>

        <!-- Admin Eraser (hidden by default, shown for admin wallets) -->
        <section id="eraser-section" class="eraser-section hidden">
          <h3>Admin Tools <span class="shortcut-hint">(E)</span></h3>
          <button id="eraser-btn" class="eraser-btn">
            <span class="eraser-icon">â—Œ</span>
            <span class="eraser-label">Eraser</span>
          </button>
          <p class="eraser-hint">Click pixels to erase them</p>
        </section>

        <!-- Status Row -->
        <div class="status-row">
          <div class="coords-display">
            <span class="coords-label">XY</span>
            <span id="cursor-coords" class="coords-value">â€”</span>
          </div>
          <div class="connection-status" id="connection-status">
            <span class="status-dot" id="status-dot"></span>
            <span class="status-text" id="ws-status-text">Live</span>
          </div>
        </div>

        <!-- Canvas Full Status -->
        <div class="canvas-full-status hidden" id="canvas-full-status">
          <span class="full-icon">ðŸŽ¨</span>
          <span class="full-text">Full!</span>
        </div>
        <div class="countdown-timer hidden" id="countdown-timer">
          Clears in --:--
        </div>
        
        <!-- Hidden elements for JS compatibility -->
        <span id="canvas-size" class="hidden">128 Ã— 128</span>

      </aside>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p class="credits">REMI / Place<br>Architected by @0xsimba7 Â· Developed by @legendarylibr</p>
      <div class="donation-hint">
        <span class="donation-label">â˜• Support</span>
        <span class="donation-address" title="Click to copy">0x5d0adaacB66541993aEf0038E347D31633F7265E</span>
      </div>
    </footer>
  </div>

  <script src="dist/bundle.a433dcab.js" type="module"></script>
  <script>
    document.querySelector('.donation-address')?.addEventListener('click', async function() {
      try {
        await navigator.clipboard.writeText(this.textContent);
        const original = this.textContent;
        this.textContent = 'Copied!';
        this.style.color = 'var(--color-success)';
        setTimeout(() => {
          this.textContent = original;
          this.style.color = '';
        }, 1500);
      } catch (e) {}
    });
  </script>
</body>
</html>
